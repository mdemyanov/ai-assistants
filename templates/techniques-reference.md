---
tags: [reference, techniques, prompting]
created: 2025-05-28
updated: 2025-05-28
---

# Техники Prompt Engineering

Справочник техник с примерами для создания эффективных промтов.

## Chain-of-Thought (CoT)

**Когда использовать:** Сложные рассуждения, многошаговые задачи, анализ, математика.

**Принцип:** Заставить модель "думать вслух", разбивая задачу на шаги.

### Примеры формулировок

**Базовый CoT:**
```
Думай пошагово. Сначала проанализируй [X], затем определи [Y], и на основе этого сформулируй [Z].
```

**Структурированный CoT:**
```
Перед ответом выполни следующие шаги:
1. Определи ключевые факторы проблемы
2. Рассмотри возможные подходы к решению
3. Оцени плюсы и минусы каждого
4. Выбери оптимальный и обоснуй выбор
```

**CoT с явным выводом:**
```
Проанализируй ситуацию шаг за шагом, затем в конце дай чёткую рекомендацию в формате:
РЕКОМЕНДАЦИЯ: [одно предложение]
ОБОСНОВАНИЕ: [2-3 предложения]
```

### Антипаттерн
```
❌ "Подумай хорошо и дай ответ"
```
Почему плохо: Слишком абстрактно, нет структуры для рассуждений.

---

## Few-Shot Learning

**Когда использовать:** Специфический формат вывода, нестандартный стиль, классификация.

**Принцип:** Показать примеры желаемого входа и выхода.

### Примеры формулировок

**Для формата ответа:**
```
Преобразуй описание задачи в user story по примерам:

Пример 1:
Вход: "Пользователь должен видеть историю заказов"
Выход: "Как покупатель, я хочу видеть историю своих заказов, чтобы отслеживать покупки"

Пример 2:
Вход: "Админ может блокировать пользователей"
Выход: "Как администратор, я хочу блокировать пользователей, чтобы предотвращать нарушения"

Теперь преобразуй:
Вход: "[задача пользователя]"
```

**Для стиля/тона:**
```
Пиши в стиле технической документации. Примеры:

✓ "Метод возвращает массив объектов типа User"
✓ "При ошибке выбрасывается исключение ValidationError"

✗ "Эта штука отдаёт список юзеров"
✗ "Если что-то пойдёт не так, будет ошибка"
```

### Антипаттерн
```
❌ "Напиши как в прошлый раз" (без примера)
❌ Один пример для сложного формата
```
Почему плохо: Модель не имеет контекста прошлых разговоров; один пример недостаточен для выявления паттерна.

---

## Role-Playing

**Когда использовать:** Экспертные задачи, специфическая перспектива, глубокий анализ.

**Принцип:** Назначить модели роль с конкретной экспертизой и точкой зрения.

### Примеры формулировок

**Базовая роль:**
```
Ты — опытный продакт-менеджер с 10-летним стажем в B2B SaaS. 
Проанализируй этот feature request с точки зрения бизнес-ценности.
```

**Роль с ограничениями:**
```
Ты — senior backend разработчик, специализирующийся на высоконагруженных системах.
Ты скептически относишься к преждевременной оптимизации, но внимателен к архитектурным решениям.
Проведи code review этого PR.
```

**Мультиперспектива:**
```
Проанализируй это решение с трёх точек зрения:

1. Как CTO: фокус на технический долг и масштабируемость
2. Как CFO: фокус на затраты и ROI
3. Как CPO: фокус на пользовательский опыт и time-to-market

Затем синтезируй рекомендацию, учитывающую все три перспективы.
```

### Антипаттерн
```
❌ "Ты эксперт. Помоги мне."
```
Почему плохо: Нет конкретики — какой эксперт? В чём экспертиза? Какая перспектива?

---

## Structured Output

**Когда использовать:** Данные для дальнейшей обработки, отчёты, стандартизированные ответы.

**Принцип:** Явно задать формат и структуру ответа.

### Примеры формулировок

**JSON-формат:**
```
Проанализируй текст и верни результат строго в JSON:

{
  "sentiment": "positive" | "negative" | "neutral",
  "confidence": 0.0-1.0,
  "key_topics": ["topic1", "topic2"],
  "summary": "одно предложение"
}

Не добавляй никакого текста до или после JSON.
```

**Табличный формат:**
```
Сравни варианты в формате таблицы:

| Критерий | Вариант A | Вариант B | Победитель |
|----------|-----------|-----------|------------|
| [критерий] | [оценка] | [оценка] | A/B/Ничья |

После таблицы дай итоговую рекомендацию в одном абзаце.
```

**Секционный формат:**
```
Структурируй ответ по секциям:

## Проблема
[2-3 предложения]

## Корневая причина
[2-3 предложения]

## Решение
[пронумерованные шаги]

## Риски
[bullet points]
```

### Антипаттерн
```
❌ "Дай структурированный ответ"
```
Почему плохо: Не указана конкретная структура — модель выберет свою.

---

## Self-Reflection / Self-Critique

**Когда использовать:** Критически важные решения, поиск ошибок, повышение качества.

**Принцип:** Заставить модель проверить и улучшить свой ответ.

### Примеры формулировок

**Базовая самопроверка:**
```
После ответа проверь себя:
- Все ли требования учтены?
- Нет ли логических противоречий?
- Что может пойти не так?

Если найдёшь проблемы — исправь ответ.
```

**Критика с итерацией:**
```
Шаг 1: Предложи решение
Шаг 2: Выступи как критик — найди 3 слабых места в своём решении
Шаг 3: Улучши решение, устранив эти слабости
Шаг 4: Дай финальный ответ
```

**Проверка на полноту:**
```
В конце ответа добавь секцию:

## Самопроверка
- Учтённые аспекты: [список]
- Потенциально упущенное: [список]
- Уровень уверенности: [высокий/средний/низкий]
- Рекомендация по верификации: [что проверить дополнительно]
```

### Антипаттерн
```
❌ "Убедись, что ответ правильный"
```
Почему плохо: Нет критериев проверки — модель формально "убедится".

---

## Constraint Setting

**Когда использовать:** Контроль объёма, исключение нежелательного, фокусировка.

**Принцип:** Явно указать границы и ограничения.

### Примеры формулировок

**Ограничение объёма:**
```
Объясни концепцию в 3-5 предложениях. Не больше.
```

**Исключения:**
```
Предложи решения, НЕ включающие:
- Увеличение бюджета
- Найм новых сотрудников
- Изменение сроков
```

**Фокусировка:**
```
Отвечай ТОЛЬКО на заданный вопрос. 
Не добавляй контекст, предысторию или связанные темы, если я не попрошу.
```

**Уровень детализации:**
```
Уровень детализации: executive summary.
Без технических деталей, только бизнес-импликации.
Целевая аудитория: CEO без технического бэкграунда.
```

---

## Комбинирование техник

Техники работают лучше в комбинации. Пример комплексного промта:

```
# Роль (Role-Playing)
Ты — senior архитектор с опытом миграции монолитов на микросервисы.

# Задача
Проанализируй предложенную архитектуру.

# Процесс (Chain-of-Thought)
1. Определи основные компоненты и их связи
2. Выяви потенциальные проблемы масштабирования
3. Предложи улучшения

# Формат (Structured Output)
## Текущее состояние
[анализ]

## Проблемы
| Проблема | Критичность | Компонент |
|----------|-------------|-----------|

## Рекомендации
[пронумерованный список]

# Самопроверка (Self-Reflection)
В конце укажи уровень уверенности и что требует дополнительного изучения.

# Ограничения (Constraints)
- Бюджет: средний (без enterprise-решений)
- Команда: 5 разработчиков
- Срок: 6 месяцев
```

---

## Быстрый выбор техники

| Задача | Основная техника | Дополнительно |
|--------|------------------|---------------|
| Анализ проблемы | Chain-of-Thought | Self-Reflection |
| Генерация в формате | Structured Output | Few-Shot |
| Экспертная оценка | Role-Playing | Constraints |
| Классификация | Few-Shot | Structured Output |
| Критический разбор | Self-Reflection | Role-Playing |
| Креативные задачи | Role-Playing | Constraints (для фокуса) |
